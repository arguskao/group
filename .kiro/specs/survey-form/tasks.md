# 實作計畫

- [x] 1. 建立專案結構和基礎設定
  - 建立 HTML 檔案結構
  - 設定 CSS 框架（Tailwind CSS 或自訂樣式）
  - 建立 JavaScript 模組結構
  - 設定測試環境（Jest/Vitest 和 fast-check）
  - _需求：10.1, 10.2_

- [x] 2. 實作資料模型和常數定義
  - 定義 SurveyResponse 介面
  - 定義 Statistics 介面
  - 定義 ValidationResult 和 ValidationError 介面
  - 定義台灣地區常數陣列（22 個縣市）
  - 定義職業類型常數陣列
  - 定義管理員密碼常數
  - _需求：4.2, 5.2, 9.5_

- [x] 3. 實作 Validator 類別
- [x] 3.1 實作姓名驗證邏輯
  - 實作 validateName 方法
  - 檢查空值
  - 驗證中文、英文字母和空格
  - _需求：2.3, 2.4_

- [x] 3.2 撰寫屬性測試：表單輸入接受
  - **Property 1: 表單輸入接受**
  - **驗證需求：2.4**

- [x] 3.3 實作電話驗證邏輯
  - 實作 validatePhone 方法
  - 檢查空值
  - 驗證格式（數字、連字號、空格）
  - 驗證長度（8-15 位數字）
  - _需求：3.3, 3.4, 3.5_

- [x] 3.4 撰寫屬性測試：電話格式驗證
  - **Property 3: 電話格式驗證**
  - **驗證需求：3.4, 3.5**

- [x] 3.5 實作地區和職業驗證邏輯
  - 實作 validateRegion 方法
  - 實作 validateOccupation 方法
  - 檢查是否為有效選項
  - _需求：4.5, 5.5_

- [x] 3.6 實作完整表單驗證
  - 實作 validateForm 方法
  - 整合所有欄位驗證
  - 收集所有驗證錯誤
  - _需求：6.5_

- [x] 3.7 撰寫屬性測試：不完整表單驗證
  - **Property 9: 不完整表單驗證**
  - **驗證需求：6.5**

- [x] 4. 實作 CSVManager 類別
- [x] 4.1 實作 CSV 特殊字元轉義
  - 實作 escapeField 方法
  - 處理逗號轉義
  - 處理引號轉義
  - 處理換行符轉義
  - _需求：8.5_

- [x] 4.2 撰寫屬性測試：CSV 特殊字元處理
  - **Property 17: CSV 特殊字元處理**
  - **驗證需求：8.5**

- [x] 4.3 實作 CSV 格式化
  - 實作 toCSV 方法
  - 生成標題列
  - 格式化每一行資料
  - _需求：8.2, 8.3_

- [x] 4.4 撰寫屬性測試：CSV 格式化
  - **Property 15: CSV 格式化**
  - **驗證需求：8.2**

- [x] 4.5 實作 CSV 解析
  - 實作 fromCSV 方法
  - 解析標題列
  - 解析資料列
  - 處理轉義字元
  - _需求：8.4_

- [x] 4.6 撰寫屬性測試：CSV 往返一致性
  - **Property 16: CSV 往返一致性**
  - **驗證需求：8.4**

- [x] 4.7 實作 localStorage 讀寫
  - 實作 append 方法（新增回覆）
  - 實作 readAll 方法（讀取所有回覆）
  - 處理檔案不存在的情況
  - _需求：8.1, 8.4, 8.6_

- [x] 4.8 撰寫屬性測試：CSV 資料附加
  - **Property 14: CSV 資料附加**
  - **驗證需求：8.1**

- [x] 4.9 實作 CSV 下載功能
  - 實作 download 方法
  - 生成時間戳記檔名
  - 建立 Blob 並觸發下載
  - 確保 UTF-8 編碼
  - _需求：9.3, 9.6, 9.7_

- [x] 4.10 撰寫屬性測試：下載檔案命名
  - **Property 19: 下載檔案命名**
  - **驗證需求：9.6**

- [x] 4.11 撰寫屬性測試：UTF-8 編碼保持
  - **Property 20: UTF-8 編碼保持**
  - **驗證需求：9.7**

- [x] 5. 實作 AuthManager 類別
- [x] 5.1 實作密碼驗證
  - 實作 authenticate 方法
  - 比對輸入密碼與設定密碼
  - _需求：9.3, 9.4, 9.5_

- [x] 5.2 撰寫屬性測試：錯誤密碼拒絕
  - **Property 18: 錯誤密碼拒絕**
  - **驗證需求：9.4**

- [x] 6. 實作 SurveyForm 元件
- [x] 6.1 建立 HTML 表單結構
  - 建立介紹文字區域
  - 建立姓名輸入欄位
  - 建立電話輸入欄位
  - 建立地區下拉選單
  - 建立職業下拉選單
  - 建立提交按鈕
  - _需求：1.1, 1.3, 2.1, 3.1, 4.1, 5.1, 6.1_

- [x] 6.2 實作表單資料收集
  - 實作 getData 方法
  - 收集所有欄位值
  - 生成時間戳記
  - _需求：6.2_

- [x] 6.3 實作表單驗證整合
  - 實作 validate 方法
  - 呼叫 Validator 進行驗證
  - _需求：6.5_

- [x] 6.4 實作錯誤訊息顯示
  - 實作 showErrors 方法
  - 在對應欄位顯示錯誤訊息
  - 使用 aria-describedby 提升無障礙性
  - _需求：2.3, 3.3, 4.5, 5.5, 6.5_

- [x] 6.5 實作表單清空功能
  - 實作 clear 方法
  - 清空所有輸入欄位
  - 重置下拉選單
  - _需求：6.3_

- [x] 6.6 撰寫屬性測試：提交後表單清空
  - **Property 7: 提交後表單清空**
  - **驗證需求：6.3**

- [x] 6.7 實作表單提交處理
  - 綁定提交按鈕事件
  - 驗證表單
  - 呼叫 onSubmit 回調
  - 清空表單
  - _需求：6.2, 6.3_

- [x] 6.8 撰寫屬性測試：有效表單提交儲存
  - **Property 6: 有效表單提交儲存**
  - **驗證需求：6.2**

- [x] 7. 實作 StatisticsPanel 元件
- [x] 7.1 建立統計面板 HTML 結構
  - 建立總計數顯示區域
  - 建立地區統計顯示區域
  - 建立職業統計顯示區域
  - _需求：7.1_

- [x] 7.2 實作統計計算邏輯
  - 實作 calculateStats 方法
  - 計算總回覆數
  - 計算地區分組統計
  - 計算職業分組統計
  - _需求：7.2, 7.3, 7.4, 7.5_

- [ ] 7.3 撰寫屬性測試：回覆計數增加
  - **Property 10: 回覆計數增加**
  - **驗證需求：7.2**

- [ ] 7.4 撰寫屬性測試：地區分組統計
  - **Property 11: 地區分組統計**
  - **驗證需求：7.3**

- [ ] 7.5 撰寫屬性測試：職業分組統計
  - **Property 12: 職業分組統計**
  - **驗證需求：7.4**

- [ ] 7.6 撰寫屬性測試：統計計數準確性
  - **Property 13: 統計計數準確性**
  - **驗證需求：7.5**

- [x] 7.7 實作統計面板渲染
  - 實作 render 方法
  - 顯示總計數
  - 顯示地區統計表格
  - 顯示職業統計表格
  - _需求：7.1, 7.3, 7.4_

- [x] 7.8 實作統計更新功能
  - 實作 update 方法
  - 呼叫 calculateStats
  - 呼叫 render
  - _需求：6.4, 7.5_

- [ ] 7.9 撰寫屬性測試：提交後統計更新
  - **Property 8: 提交後統計更新**
  - **驗證需求：6.4**

- [x] 8. 實作下載功能
- [x] 8.1 建立下載按鈕 UI
  - 在統計面板下方加入下載按鈕
  - _需求：9.1_

- [x] 8.2 實作密碼提示對話框
  - 建立密碼輸入對話框
  - 顯示錯誤訊息區域
  - _需求：9.2_

- [x] 8.3 整合下載功能
  - 綁定下載按鈕點擊事件
  - 顯示密碼對話框
  - 呼叫 AuthManager 驗證
  - 驗證成功後呼叫 CSVManager.download
  - 顯示錯誤訊息（如果密碼錯誤）
  - _需求：9.2, 9.3, 9.4_

- [x] 9. 整合應用程式
- [x] 9.1 建立主應用程式類別
  - 初始化 CSVManager
  - 初始化 AuthManager
  - 初始化 SurveyForm
  - 初始化 StatisticsPanel
  - _需求：10.1_

- [x] 9.2 實作應用程式初始化
  - 從 localStorage 載入現有資料
  - 初始化統計面板
  - 綁定表單提交事件
  - _需求：8.4, 7.6_

- [x] 9.3 實作表單提交流程
  - 接收表單資料
  - 儲存到 CSVManager
  - 更新統計面板
  - _需求：6.2, 6.4, 8.1_

- [ ] 10. 樣式和 UI 優化
- [ ] 10.1 實作響應式設計
  - 桌面版面配置
  - 行動裝置版面配置
  - 表單欄位樣式
  - 統計面板樣式
  - _需求：1.2_

- [ ] 10.2 實作無障礙功能
  - 為所有表單欄位加入適當的 label
  - 使用語意化 HTML
  - 支援鍵盤導航
  - 錯誤訊息與欄位關聯
  - _需求：2.1, 3.1, 4.1, 5.1_

- [ ] 10.3 優化使用者體驗
  - 加入載入動畫
  - 加入成功提交提示
  - 優化錯誤訊息顯示
  - 加入表單欄位提示文字
  - _需求：1.2, 6.3, 6.4_

- [x] 11. 檢查點 - 確保所有測試通過
  - 確保所有測試通過，如有問題請詢問使用者

- [x] 12. 部署準備
- [x] 12.1 建立 Cloudflare Pages 設定
  - 建立 package.json（如果使用建置工具）
  - 設定建置指令（如果需要）
  - 確認靜態檔案結構
  - _需求：10.1, 10.4_

- [x] 12.2 測試瀏覽器相容性
  - 測試 Chrome
  - 測試 Firefox
  - 測試 Safari
  - 測試行動瀏覽器
  - _需求：10.2, 10.4_

- [x] 12.3 建立部署文件
  - 撰寫 README.md
  - 說明部署步驟
  - 說明管理員密碼使用方式
  - _需求：10.1_

- [ ] 13. 最終檢查點 - 確保所有測試通過
  - 確保所有測試通過，如有問題請詢問使用者
